// Copyright 2025 Shuai Zhang
// SPDX-License-Identifier: LGPL-3.0-or-later WITH LGPL-3.0-linking-exception

amends "package://github.com/jdx/hk/releases/download/v1.20.0/hk@1.20.0#/Config.pkl"
import "package://github.com/jdx/hk/releases/download/v1.20.0/hk@1.20.0#/Builtins.pkl"

import "./src/hk/steps.pkl"

local default_linters = new Mapping<String, Step> {
  ["nwa"] = steps.nwa
}

local pkl_linters = new Mapping<String, Step> {
  ["pkl"] = Builtins.pkl
  ["pkl-format"] = steps.pklFormat
}

local all_linters = new Mapping<String, Step> {
  ...default_linters
  ...pkl_linters
}

hooks {
  ["pre-commit"] {
    fix = false
    steps = all_linters
  }
  ["pre-push"] {
    steps = all_linters
  }
  ["fix"] {
    fix = true
    steps = all_linters
  }
  ["check"] {
    steps = all_linters
  }
}
